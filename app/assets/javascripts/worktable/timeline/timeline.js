// Generated by CoffeeScript 1.9.2
var setupTimeLineCss, setupTimeLineObjects, setupTimelineEvents, updateSelectItemMenu;

setupTimelineEvents = function() {
  var _clickTimelineEvent, _createTimelineEvent, self, te;
  self = this;
  te = null;

  /* private method ここから */
  _createTimelineEvent = function(e) {
    var newEmt, pEmt, teNum;
    pEmt = $('#timeline_events');
    newEmt = $('.timeline_event_temp', pEmt).children(':first').clone(true);
    teNum = getPageValue(Constant.PageValueKey.TE_COUNT) + 1;
    newEmt.find('.te_num').val(teNum);
    return pEmt.append(newEmt);
  };
  _clickTimelineEvent = function(e) {
    var eId, emt, te_num;
    if ($(e).is('.ui-sortable-helper')) {
      return;
    }
    clearSelectedBorder();
    setSelectedBorder(e, "timeline");
    switchSidebarConfig("timeline");
    te_num = $(e).find('input.te_num').val();
    eId = TimelineConfig.ITEM_ROOT_ID.replace('@te_num', te_num);
    emt = $('#' + eId);
    if (emt.length === 0) {
      emt = $('#timeline-config .timeline_temp .event').clone(true).attr('id', eId);
      $('#timeline-config').append(emt);
    }
    updateSelectItemMenu();
    te = new TimelineConfig(emt, e);
    (function(_this) {
      return (function() {
        var em;
        em = $('.te_item_select', emt);
        em.off('change');
        em.on('change', function(e) {
          return te.selectItem(this);
        });
        em = $('.action_forms li', emt);
        em.off('click');
        em.on('click', function(e) {
          return te.clickMethod(this);
        });
        em = $('.push.button.reset', emt);
        em.off('click');
        em.on('click', function(e) {
          return te.resetAction();
        });
        em = $('.push.button.apply', emt);
        em.off('click');
        em.on('click', function(e) {
          te.applyAction();
          return _createTimelineEvent.call(self, e);
        });
        em = $('.push.button.cancel', emt);
        em.off('click');
        return em.on('click', function(e) {
          emt = $(this).closest('.event');
          $('.values', emt).html('');
          return closeSidebar(function() {
            return $(".config.te_div", emt).css('display', 'none');
          });
        });
      });
    })(this)();
    $('#timeline-config .event').css('display', 'none');
    emt.css('display', '');
    if (!isOpenedConfigSidebar()) {
      openConfigSidebar();
    }
    if ($(e).hasClass('blank')) {

    } else {

    }
  };

  /* private method ここまで */
  $('.timeline_event').off('click');
  $('.timeline_event').on('click', function(e) {
    return _clickTimelineEvent.call(self, this);
  });
  return $('#timeline_events').sortable({
    revert: true,
    axis: 'x',
    containment: $('#timeline_events_container'),
    items: '.sortable',
    stop: function(event, ui) {}
  });
};

updateSelectItemMenu = function() {
  var items, selectOptions, teItemSelect, teItemSelects;
  teItemSelects = $('#timeline-config .te_item_select');
  teItemSelect = teItemSelects[0];
  selectOptions = '';
  items = $('#page_values .item');
  items.children().each(function() {
    var id, itemId, name;
    id = $(this).find('input.id').val();
    name = $(this).find('input.name').val();
    itemId = $(this).find('input.itemId').val();
    return selectOptions += "<option value='" + id + Constant.TIMELINE_ITEM_SEPERATOR + itemId + "'>\n  " + name + "\n</option>";
  });
  return teItemSelects.each(function() {
    $(this).find('option').each(function() {
      if ($(this).val().length > 0 && $(this).val().indexOf(Constant.TIMELINE_COMMON_PREFIX) !== 0) {
        return $(this).remove();
      }
    });
    return $(this).append($(selectOptions));
  });
};

setupTimeLineObjects = function() {
  var objList;
  objList = [];
  itemObjectList.forEach(function(item) {
    var obj;
    obj = {
      chapter: 1,
      screen: 1,
      miniObj: item.getMinimumObject(),
      itemSize: item.itemSize,
      sEvent: "scrollDraw",
      cEvent: "defaultClick"
    };
    return objList.push(obj);
  });
  return objList;
};

setupTimeLineCss = function() {
  var itemCssStyle;
  itemCssStyle = "";
  $('#css_code_info').find('.css-style').each(function() {
    return itemCssStyle += $(this).html();
  });
  itemObjectList.forEach(function(item) {
    if ((typeof ButtonItem !== "undefined" && ButtonItem !== null) && item instanceof ButtonItem) {
      return itemCssStyle += ButtonItem.dentButton(item);
    }
  });
  return itemCssStyle;
};

//# sourceMappingURL=timeline.js.map
