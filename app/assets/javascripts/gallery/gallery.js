// Generated by CoffeeScript 1.9.2
var GalleryGrid;

GalleryGrid = (function() {
  function GalleryGrid() {}

  GalleryGrid.initEvent = function() {
    this.initContentsHover();
    return this.initLoadMoreButtonEvent();
  };

  GalleryGrid.initContentsHover = function() {
    $('.grid_contents_wrapper').off('mouseenter').on('mouseenter', function(e) {
      e.preventDefault();
      return $(this).find('.hover_overlay').stop(true, true).fadeIn('100');
    });
    return $('.grid_contents_wrapper').off('mouseleave').on('mouseleave', function(e) {
      e.preventDefault();
      return $(this).find('.hover_overlay').stop(true, true).fadeOut('300');
    });
  };

  GalleryGrid.initLoadMoreButtonEvent = function() {
    return $(".footer_button > button").click(function() {
      Common.showModalFlashMessage('Loading...');
      $.ajax({
        url: "/gallery/grid_ajax",
        type: "GET",
        dataType: "html",
        success: function(data) {
          var $grid, d;
          if (data != null) {
            d = GalleryCommon.addGridContentsStyle($(data.trim()).filter('.grid_contents_wrapper'));
            $grid = $('#grid_wrapper');
            $grid.append(d).masonry('appended', d);
            return Common.hideModalView(true);
          } else {
            console.log('/gallery/grid_ajax server error');
            return Common.ajaxError(data);
          }
        },
        error: function(data) {
          console.log('/gallery/grid_ajax ajax error');
          return Common.ajaxError(data);
        }
      });
      return false;
    });
  };

  return GalleryGrid;

})();

$(function() {
  window.isMotionCheck = false;
  window.isItemPreview = false;
  GalleryCommon.initView();
  $('.gallery.index').ready(function() {});
  $('.gallery.grid').ready(function() {
    GalleryCommon.initGridView();
    return GalleryGrid.initEvent();
  });
  $('.gallery.detail').ready(function() {
    RunCommon.showCreatorInfo();
    return RunCommon.start();
  });
  $('.gallery.full_window').ready(function() {
    RunFullScreen.showCreatorInfo();
    return RunCommon.start();
  });
  $('.gallery.embed').ready(function() {
    $('.powered_thumbnail:first').off('click').on('click', (function(_this) {
      return function(e) {
        e.preventDefault();
        return window.open("/", "_newwindow");
      };
    })(this));
    $('.play_in_embed:first').off('click').on('click', (function(_this) {
      return function(e) {
        var accessToken;
        e.preventDefault();
        accessToken = $("#main_wrapper ." + constant.Gallery.Key.GALLERY_ACCESS_TOKEN + ":first").val();
        return window.location.href = "/gallery/embed_with_run?" + constant.Gallery.Key.GALLERY_ACCESS_TOKEN + "=" + accessToken;
      };
    })(this));
    return $('.play_in_site_link:first').off('click').on('click', (function(_this) {
      return function(e) {
        var accessToken;
        e.preventDefault();
        accessToken = $("#main_wrapper ." + constant.Gallery.Key.GALLERY_ACCESS_TOKEN + ":first").val();
        return window.open("/gallery/detail/" + accessToken, "_newwindow");
      };
    })(this));
  });
  return $('.gallery.embed_with_run').ready(function() {
    RunFullScreen.showCreatorInfo();
    return RunCommon.start();
  });
});

//# sourceMappingURL=gallery.js.map
