// Generated by CoffeeScript 1.9.2
var UploadBase;

UploadBase = (function() {
  function UploadBase() {}

  UploadBase.prototype.prepareUploadTagEvent = function(root) {
    var tags;
    tags = $('.popular_tag a, .recommend_tag a', root);
    tags.off('click').on('click', (function(_this) {
      return function(e) {
        return _this.addUploadSelectTag(root, $(e.target).html());
      };
    })(this));
    tags.off('mouseenter').on('mouseenter', (function(_this) {
      return function(e) {
        var li;
        li = $(e.target).closest('li');
        $(li).append($("<div class='add_pop pop' style='display:none'><p>Add tag(click)</p></div>"));
        $('.add_pop', li).css({
          top: $(li).height(),
          left: $(li).width()
        });
        return $('.add_pop', li).show();
      };
    })(this));
    return tags.off('mouseleave').on('mouseleave', (function(_this) {
      return function(e) {
        var ul;
        ul = $(e.target).closest('ul');
        return $('.add_pop', ul).remove();
      };
    })(this));
  };

  UploadBase.prototype.addUploadSelectTag = function(root, tagname) {
    var tags, ul;
    ul = $('.select_tag ul', root);
    tags = $.map(ul.children(), function(n) {
      return $('a', n).html();
    });
    if (tags.length >= constant.Gallery.TAG_MAX || $.inArray(tagname, tags) >= 0) {
      return;
    }
    ul.append($("<li><a href='#'>" + tagname + "</a></li>"));
    $('a', ul).off('click');
    $('a', ul).on('click', function(e) {
      this.closest('li').remove();
      if ($('.select_tag ul li', root).length < constant.Gallery.TAG_MAX) {
        return $('.select_tag_input', root).show();
      }
    });
    $('a', ul).off('mouseenter');
    $('a', ul).on('mouseenter', function(e) {
      var li;
      li = this.closest('li');
      $(li).append($("<div class='delete_pop pop' style='display:none'><p>Delete tag(click)</p></div>"));
      $('.delete_pop', li).css({
        top: $(li).height(),
        left: $(li).width()
      });
      return $('.delete_pop', li).show();
    });
    $('a', ul).off('mouseleave');
    $('a', ul).on('mouseleave', function(e) {
      return $('li .delete_pop', ul).remove();
    });
    if ($('.select_tag ul li', root).length >= constant.Gallery.TAG_MAX) {
      return $('.select_tag_input', root).hide();
    }
  };

  UploadBase.prototype.upload = function(root, callback) {
    if (callback == null) {
      callback = null;
    }
  };

  return UploadBase;

})();

//# sourceMappingURL=upload_base.js.map
