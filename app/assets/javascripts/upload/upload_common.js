// Generated by CoffeeScript 1.9.2
var UploadCommon;

UploadCommon = (function() {
  function UploadCommon() {}

  UploadCommon.initEvent = function(upload) {
    var mark, root;
    root = $('#upload_wrapper');
    mark = $('.markItUp', root);
    if ((mark != null) && mark.length > 0) {
      $('.caption_markup', root).markItUpRemove();
    }
    $('.caption_markup', root).markItUp(mySettings);
    upload.prepareUploadTagEvent(root);
    $('.select_tag_input', root).off('keypress').on('keypress', function(e) {
      if (e.keyCode === Constant.KeyboardKeyCode.ENTER) {
        upload.addUploadSelectTag(root, $(this).val());
        return $(this).val('');
      }
    });
    return $('.upload_button').off('click').on('click', function() {
      upload.upload(root);
      return false;
    });
  };

  UploadCommon.makeCapture = function(canvas) {
    var height, png, root, width;
    root = $('#upload_wrapper');
    try {
      png = canvas.toDataURL('image/png');
      $(".capture", root).attr('src', png);
      $("input[name='" + Constant.Gallery.Key.THUMBNAIL_IMG + "']", root).val(png.replace(/^.*,/, ''));
    } catch (_error) {
      $(".capture", root).attr('src', '');
    }
    $("input[name='" + Constant.Gallery.Key.THUMBNAIL_IMG_CONTENTSTYPE + "']", root).val('image/png');
    width = parseInt($(canvas).attr('width'));
    height = parseInt($(canvas).attr('height'));
    $("input[name='" + Constant.Gallery.Key.THUMBNAIL_IMG_WIDTH + "']", root).val(width);
    $("input[name='" + Constant.Gallery.Key.THUMBNAIL_IMG_HEIGHT + "']", root).val(height);
    if (width > height) {
      return $(".capture", root).css({
        width: '100%',
        height: 'auto'
      });
    } else {
      return $(".capture", root).css({
        width: 'auto',
        height: '100%'
      });
    }
  };

  return UploadCommon;

})();

//# sourceMappingURL=upload_common.js.map
