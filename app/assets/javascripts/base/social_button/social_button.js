// Generated by CoffeeScript 1.9.2
var bindFacebookEvents, bindTwitterEventHandlers, fb_events_bound, fb_root, initializeFacebookSDK, loadFacebookSDK, loadGoogleSDK, loadHatenaSDK, loadPocketSDK, loadTwitterSDK, ready, renderTweetButtons, restoreFacebookRoot, saveFacebookRoot, twttr_events_bound;

ready = function() {
  loadFacebookSDK();
  if (!fb_events_bound) {
    bindFacebookEvents();
  }
  loadGoogleSDK();
  loadTwitterSDK();
  if (!twttr_events_bound) {
    bindTwitterEventHandlers();
  }
  loadHatenaSDK();
  return loadPocketSDK();
};

$(document).ready(ready);

$(document).on('page:load', ready);

fb_root = null;

fb_events_bound = false;

bindFacebookEvents = function() {
  $(document).on('page:fetch', saveFacebookRoot).on('page:change', restoreFacebookRoot).on('page:load', function() {
    return typeof FB !== "undefined" && FB !== null ? FB.XFBML.parse() : void 0;
  });
  return fb_events_bound = true;
};

saveFacebookRoot = function() {
  return fb_root = $('#fb-root').detach();
};

restoreFacebookRoot = function() {
  if ($('#fb-root').length > 0) {
    return $('#fb-root').replaceWith(fb_root);
  } else {
    return $('body').append(fb_root);
  }
};

loadFacebookSDK = function() {
  window.fbAsyncInit = initializeFacebookSDK;
  return $.getScript("//connect.facebook.net/ja_JP/all.js#xfbml=1");
};

initializeFacebookSDK = function() {
  return FB.init({
    appId: serverenv.OMNIAUTH_FACEBOOK_KEY,
    channelUrl: document.domain + "/sb/fb_channel.html",
    status: true,
    cookie: true,
    xfbml: true
  });
};

twttr_events_bound = false;

bindTwitterEventHandlers = function() {
  $(document).on('page:load', renderTweetButtons);
  return twttr_events_bound = true;
};

renderTweetButtons = function() {
  $('.twitter-share-button').each(function() {
    var button;
    button = $(this);
    if (button.data('url') == null) {
      button.attr('data-url', document.location.href);
    }
    if (button.data('text') == null) {
      return button.attr('data-text', document.title);
    }
  });
  return twttr.widgets.load();
};

loadTwitterSDK = function() {
  return $.getScript("//platform.twitter.com/widgets.js");
};

loadGoogleSDK = function() {
  return $.getScript("https://apis.google.com/js/plusone.js");
};

loadHatenaSDK = function() {
  return $.getScript("//b.st-hatena.com/js/bookmark_button_wo_al.js");
};

loadPocketSDK = function() {
  return $.getScript("https://widgets.getpocket.com/v1/j/btn.js?v=1");
};

//# sourceMappingURL=social_button.js.map
