// Generated by CoffeeScript 1.9.2
var LocalStorage;

LocalStorage = (function() {
  LocalStorage.Key = (function() {
    function Key() {}

    Key.WORKTABLE_EVENT_PAGEVALUES = 'worktable_event_pagevalues';

    Key.RUN_EVENT_PAGEVALUES = 'run_event_pagevalues';

    return Key;

  })();

  LocalStorage.SAVETIME_SUFFIX = '_time';

  LocalStorage.SAVETIME_LIMIT_MINUTES = {};

  LocalStorage.SAVETIME_LIMIT_MINUTES[LocalStorage.Key.WORKTABLE_EVENT_PAGEVALUES] = 5;

  function LocalStorage(key) {
    this.lstorage = localStorage;
    this.storageKey = key;
  }

  LocalStorage.prototype.saveEventPageValue = function(saveTime) {
    var h, key;
    if (saveTime == null) {
      saveTime = true;
    }
    h = PageValue.getEventPageValue(PageValue.Key.E_PREFIX);
    this.lstorage.setItem(this.storageKey, JSON.stringify(h));
    if (saveTime) {
      key = this.storageKey + this.constructor.SAVETIME_SUFFIX;
      return this.lstorage.setItem(key, $.now());
    }
  };

  LocalStorage.prototype.loadEventPageValue = function() {
    var h, k, results, v;
    h = JSON.parse(this.lstorage.getItem(this.storageKey));
    results = [];
    for (k in h) {
      v = h[k];
      results.push(PageValue.setEventPageValue(PageValue.Key.E_PREFIX + PageValue.Key.PAGE_VALUES_SEPERATOR + k, v));
    }
    return results;
  };

  LocalStorage.prototype.isOverSaveTimeLimit = function() {
    var d, duration, key, m, saveTime;
    key = this.storageKey + this.constructor.SAVETIME_SUFFIX;
    saveTime = this.lstorage.getItem(key);
    if (saveTime == null) {
      return true;
    }
    duration = $.now() - saveTime;
    d = new Date(duration);
    m = d.getMinutes();
    return parseInt(m) > this.constructor.SAVETIME_LIMIT_MINUTES[this.storageKey];
  };

  LocalStorage.prototype.get = function() {
    return this.lstorage.getItem(this.storageKey);
  };

  LocalStorage.prototype.set = function(value) {
    return this.lstorage.setItem(this.storageKey, value);
  };

  LocalStorage.prototype.clear = function() {
    return this.lstorage.setItem(this.storageKey, null);
  };

  return LocalStorage;

})();

//# sourceMappingURL=local_storage.js.map
